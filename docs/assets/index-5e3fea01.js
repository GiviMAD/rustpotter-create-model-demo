var Lt=Object.defineProperty;var Ct=(i,t,e)=>t in i?Lt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var xt=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var P=(i,t,e)=>(Ct(i,typeof t!="symbol"?t+"":t,e),e);var Ae=xt((Ee,St)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();const U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Tt(i){let t="";for(let e=0;e<i.length;e+=3)t+=U[i[e]>>2],t+=U[(i[e]&3)<<4|i[e+1]>>4],t+=U[(i[e+1]&15)<<2|i[e+2]>>6],t+=U[i[e+2]&63];return i.length%3===2?t=t.substring(0,t.length-1)+"=":i.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function Ft(i){let t=new Uint8Array(256);for(let s=0;s<U.length;s++)t[U.charCodeAt(s)]=s;let e=i.length*.75;i[i.length-1]==="="&&(e--,i[i.length-2]==="="&&e--);let n=new Uint8Array(e);for(let s=0,r=0;s<i.length;s+=4){let h=t[i.charCodeAt(s)],o=t[i.charCodeAt(s+1)],l=t[i.charCodeAt(s+2)],w=t[i.charCodeAt(s+3)];n[r++]=h<<2|o>>4,n[r++]=(o&15)<<4|l>>2,n[r++]=(l&3)<<6|w&63}return n}function Mt(i,t,e,n){if(["32f","64"].indexOf(t)>-1&&["32f","64"].indexOf(n)>-1){e.set(i);return}et(t),et(n);let s=At(t,n),r={oldMin:Math.pow(2,parseInt(t,10))/2,newMin:Math.pow(2,parseInt(n,10))/2,oldMax:Math.pow(2,parseInt(t,10))/2-1,newMax:Math.pow(2,parseInt(n,10))/2-1};nt(t,i,!0);for(let h=0,o=i.length;h<o;h++)e[h]=s(i[h],r);nt(n,e,!1)}function Pt(i,t){return i>0?i=parseInt(i/t.oldMax*t.newMax,10):i=parseInt(i/t.oldMin*t.newMin,10),i}function vt(i,t){return parseInt(i>0?i*t.newMax:i*t.newMin,10)}function zt(i,t){return i>0?i/t.oldMax:i/t.oldMin}function At(i,t){let e=function(n){return n};return i!=t&&(["32f","64"].includes(i)?e=vt:["32f","64"].includes(t)?e=zt:e=Pt),e}function et(i){if(i!="32f"&&i!="64"&&(parseInt(i,10)<"8"||parseInt(i,10)>"53"))throw new Error("Invalid bit depth.")}function nt(i,t,e){if(i=="8"){let n=e?-128:128;for(let s=0,r=t.length;s<r;s++)t[s]=t[s]+=n}}const ut=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],Q=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767];function Ut(i){let t={index:0,predicted:0,step:7},e=new Uint8Array(i.length),n=[],s=0,r=0;for(let o=0,l=i.length;o<l;o++)o%505==0&&o!=0&&(e.set(Bt(n,t),s),s+=256,n=[],r++),n.push(i[o]);let h=i.length/2;return h%2&&h++,e.slice(0,h+512+r*4)}function Et(i,t=256){let e={index:0,predicted:0,step:7},n=new Int16Array(i.length*2),s=[],r=0;for(let h=0,o=i.length;h<o;h++){if(h%t==0&&h!=0){let l=Rt(s,e);n.set(l,r),r+=l.length,s=[]}s.push(i[h])}return n}function Bt(i,t){let e=Xt(i[0],t);for(let n=3,s=i.length;n<s;n+=2){let r=J(i[n],t),h=J(i[n+1],t);e.push(h<<4|r)}return e}function Rt(i,t){t.predicted=Ot(i[1]<<8|i[0]),t.index=i[2],t.step=Q[t.index];let e=[t.predicted,t.predicted];for(let n=4,s=i.length;n<s;n++){let r=i[n],h=r>>4,o=h<<4^r;e.push(it(o,t)),e.push(it(h,t))}return e}function Ot(i){return i>32768?i-65536:i}function J(i,t){let e=i-t.predicted,n=0;e>=0?n=0:(n=8,e=-e);let s=Q[t.index],r=s>>3;return e>s&&(n|=4,e-=s,r+=s),s>>=1,e>s&&(n|=2,e-=s,r+=s),s>>=1,e>s&&(n|=1,r+=s),Dt(n,r,t),n}function Dt(i,t,e){i&8?e.predicted-=t:e.predicted+=t,e.predicted<-32768?e.predicted=-32768:e.predicted>32767&&(e.predicted=32767),e.index+=ut[i&7],e.index<0?e.index=0:e.index>88&&(e.index=88)}function it(i,t){let e=0;return i&4&&(e+=t.step),i&2&&(e+=t.step>>1),i&1&&(e+=t.step>>2),e+=t.step>>3,i&8&&(e=-e),t.predicted+=e,t.predicted>32767?t.predicted=32767:t.predicted<-32767&&(t.predicted=-32767),Nt(i,t),t.predicted}function Nt(i,t){t.index+=ut[i],t.index<0?t.index=0:t.index>88&&(t.index=88),t.step=Q[t.index]}function Xt(i,t){J(i,t);let e=[];return e.push(i&255),e.push(i>>8&255),e.push(t.index),e.push(0),e}const Ht=[1,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];function jt(i){let t;i=i==-32768?-32767:i;let e=~i>>8&128;if(e||(i=i*-1),i>32635&&(i=32635),i>=256){let n=Ht[i>>8&127],s=i>>n+3&15;t=n<<4|s}else t=i>>4;return t^(e^85)}function Wt(i){let t=0;i^=85,i&128&&(i&=-129,t=-1);let e=((i&240)>>4)+4,n=0;return e!=4?n=1<<e|(i&15)<<e-4|1<<e-5:n=i<<1|1,n=t===0?n:-n,n*8*-1}function qt(i){let t=new Uint8Array(i.length);for(let e=0,n=i.length;e<n;e++)t[e]=jt(i[e]);return t}function Gt(i){let t=new Int16Array(i.length);for(let e=0,n=i.length;e<n;e++)t[e]=Wt(i[e]);return t}const Vt=132,st=32635,$t=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],Zt=[0,132,396,924,1980,4092,8316,16764];function Jt(i){let t,e,n,s;return t=i>>8&128,t!=0&&(i=-i),i=i+Vt,i>st&&(i=st),e=$t[i>>7&255],n=i>>e+3&15,s=~(t|e<<4|n),s}function Kt(i){let t,e,n,s;return i=~i,t=i&128,e=i>>4&7,n=i&15,s=Zt[e]+(n<<e+3),t!=0&&(s=-s),s}function Qt(i){let t=new Uint8Array(i.length);for(let e=0,n=i.length;e<n;e++)t[e]=Jt(i[e]);return t}function Yt(i){let t=new Int16Array(i.length);for(let e=0,n=i.length;e<n;e++)t[e]=Kt(i[e]);return t}function dt(i,t,e=0,n=i.length){for(let s=e;s<n;s+=t)te(i,t,s)}function te(i,t,e){t--;for(let n=0;n<t;n++){let s=i[e+n];i[e+n]=i[e+t],i[e+t]=s,t--}}function ee(i,t=0,e=i.length){let n="";for(let s=t;s<e;){let r=128,h=191,o=!1,l=i[s++];if(l>=0&&l<=127)n+=String.fromCharCode(l);else{let w=0;l>=194&&l<=223?w=1:l>=224&&l<=239?(w=2,i[s]===224&&(r=160),i[s]===237&&(h=159)):l>=240&&l<=244?(w=3,i[s]===240&&(r=144),i[s]===244&&(h=143)):o=!0,l=l&(1<<8-w-1)-1;for(let v=0;v<w;v++)(i[s]<r||i[s]>h)&&(o=!0),l=l<<6|i[s]&63,s++;o?n+=String.fromCharCode(65533):l<=65535?n+=String.fromCharCode(l):(l-=65536,n+=String.fromCharCode((l>>10&1023)+55296,(l&1023)+56320))}}return n}function ft(i,t,e=0){let n=0,s=i.length;for(;n<s;){let r=i.codePointAt(n);if(r<128)t[e]=r,e++;else{let h=0,o=0;for(r<=2047?(h=1,o=192):r<=65535?(h=2,o=224):r<=1114111&&(h=3,o=240,n++),t[e]=(r>>6*h)+o,e++;h>0;)t[e]=128|r>>6*(h-1)&63,e++,h--}n++}return e}class ne{constructor(t,e=!1){this.bits=t,this.offset=Math.ceil(t/8),this.max=Math.pow(2,t)-1,this.min=0,this.unpack=this.unpack_,e&&(this.max=Math.pow(2,t)/2-1,this.min=-this.max-1,this.unpack=this.unpackSigned_)}pack(t,e,n=0){e=this.clamp_(Math.round(e));for(let s=0,r=this.offset;s<r;s++)t[n]=Math.floor(e/Math.pow(2,s*8))&255,n++;return n}unpack_(t,e=0){let n=0;for(let s=0;s<this.offset;s++)n+=t[e+s]*Math.pow(256,s);return n}unpackSigned_(t,e=0){return this.sign_(this.unpack_(t,e))}clamp_(t){return t>this.max?this.max:t<this.min?this.min:t}sign_(t){return t>this.max&&(t-=this.max*2+2),t}}class rt{constructor(t,e){this.offset=Math.ceil((t+e)/8),this.ebits=t,this.fbits=e,this.bias=(1<<t-1)-1,this.biasP2=Math.pow(2,this.bias+1),this.ebitsFbits=t+e,this.fbias=Math.pow(2,-(8*this.offset-1-t))}pack(t,e,n){Math.abs(e)>this.biasP2-this.ebitsFbits*2&&(e=e<0?-1/0:1/0);let s=((e=+e)||1/e)<0||e<0?1:0;e=Math.abs(e);let r=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),h=V(e/Math.pow(2,r)*Math.pow(2,this.fbits));return e!==e?(h=Math.pow(2,this.fbits-1),r=(1<<this.ebits)-1):e!==0&&(e>=Math.pow(2,1-this.bias)?(h/Math.pow(2,this.fbits)>=2&&(r=r+1,h=1),r>this.bias?(r=(1<<this.ebits)-1,h=0):(r=r+this.bias,h=V(h)-Math.pow(2,this.fbits))):(h=V(e/Math.pow(2,1-this.bias-this.fbits)),r=0)),this.packFloatBits_(t,n,s,r,h)}unpack(t,e){let n=(1<<this.ebits)-1,s,r="";for(let l=this.offset-1;l>=0;l--){let w=t[l+e].toString(2);r+="00000000".substring(w.length)+w}let h=r.charAt(0)=="1"?-1:1;r=r.substring(1);let o=parseInt(r.substring(0,this.ebits),2);return r=r.substring(this.ebits),o==n?parseInt(r,2)!==0?NaN:h*(1/0):(o===0?(o+=1,s=parseInt(r,2)):s=parseInt("1"+r,2),h*s*this.fbias*Math.pow(2,o-this.bias))}packFloatBits_(t,e,n,s,r){let h=[];h.push(n);for(let C=this.ebits;C>0;C-=1)h[C]=s%2?1:0,s=Math.floor(s/2);let o=h.length;for(let C=this.fbits;C>0;C-=1)h[o+C]=r%2?1:0,r=Math.floor(r/2);let l=h.join(""),w=this.offset+e-1,v=e;for(;w>=e;)t[w]=parseInt(l.substring(0,8),2),l=l.substring(8),w--,v++;return v}}function V(i){let t=Math.floor(i),e=i-t;return e<.5?t:e>.5||t%2?t+1:t}function E(i,t=0,e=i.length){return ee(i,t,e)}function p(i){let t=[];return ft(i,t),t}function ht(i,t,e=0){return ft(i,t,e)}function gt(i,t,e,n=0){t=t||{};let s=_t(t.bits,t.fp,t.signed),r=Math.ceil(t.bits/8),h=0,o=n;for(let l=i.length;h<l;h++)n=s.pack(e,i[h],n);return t.be&&dt(e,r,o,n),n}function z(i,t,e,n=0,s=i.length){t=t||{};let r=_t(t.bits,t.fp,t.signed);if(s=se(i,n,s,r.offset),t.be){let h=ie(i);t.be&&dt(h,r.offset,n,s),at(h,e,n,s,r)}else at(i,e,n,s,r)}function Y(i,t,e,n=0){return gt([i],t,e,n)}function a(i,t){let e=[];return Y(i,t,e,0),e}function W(i,t,e=0){let n=[];return z(i,t,n,e,e+Math.ceil(t.bits/8)),n[0]}function at(i,t,e,n,s){let r=s.offset;for(let h=0,o=e;o<n;o+=r,h++)t[h]=s.unpack(i,o)}function ie(i){return new Uint8Array(i)}function se(i,t,e,n){let s=(e-t)%n;return e-s}function _t(i,t,e){return t&&i==32?new rt(8,23):t&&i==64?new rt(11,52):new ne(i,e)}class re{constructor(){this.container="",this.chunkSize=0,this.format="",this.signature=null,this.head=0,this.uInt32={bits:32,be:!1},this.supported_containers=["RIFF","RIFX"]}setSignature(t){if(this.head=0,this.container=this.readString(t,4),this.supported_containers.indexOf(this.container)===-1)throw Error("Not a supported format.");this.uInt32.be=this.container==="RIFX",this.chunkSize=this.readUInt32(t),this.format=this.readString(t,4),this.signature={chunkId:this.container,chunkSize:this.chunkSize,format:this.format,subChunks:this.getSubChunksIndex_(t)}}findChunk(t,e=!1){let n=this.signature.subChunks,s=[];for(let r=0;r<n.length;r++)if(n[r].chunkId==t)if(e)s.push(n[r]);else return n[r];return t=="LIST"&&s.length?s:null}readString(t,e){let n="";return n=E(t,this.head,this.head+e),this.head+=e,n}readUInt32(t){let e=W(t,this.uInt32,this.head);return this.head+=4,e}getSubChunksIndex_(t){let e=[],n=this.head;for(;n<=t.length-8;)e.push(this.getSubChunkIndex_(t,n)),n+=8+e[e.length-1].chunkSize,n=n%2?n+1:n;return e}getSubChunkIndex_(t,e){let n={chunkId:this.getChunkId_(t,e),chunkSize:this.getChunkSize_(t,e)};if(n.chunkId=="LIST")n.format=E(t,e+8,e+12),this.head+=4,n.subChunks=this.getSubChunksIndex_(t);else{let s=n.chunkSize%2?n.chunkSize+1:n.chunkSize;this.head=e+8+s,n.chunkData={start:e+8,end:this.head}}return n}getChunkId_(t,e){return this.head+=4,E(t,e,e+4)}getChunkSize_(t,e){return this.head+=4,W(t,this.uInt32,e+4)}}class tt extends re{constructor(){super(),this.supported_containers.push("RF64"),this.fmt={chunkId:"",chunkSize:0,audioFormat:0,numChannels:0,sampleRate:0,byteRate:0,blockAlign:0,bitsPerSample:0,cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]},this.fact={chunkId:"",chunkSize:0,dwSampleLength:0},this.cue={chunkId:"",chunkSize:0,dwCuePoints:0,points:[]},this.smpl={chunkId:"",chunkSize:0,dwManufacturer:0,dwProduct:0,dwSamplePeriod:0,dwMIDIUnityNote:0,dwMIDIPitchFraction:0,dwSMPTEFormat:0,dwSMPTEOffset:0,dwNumSampleLoops:0,dwSamplerData:0,loops:[]},this.bext={chunkId:"",chunkSize:0,description:"",originator:"",originatorReference:"",originationDate:"",originationTime:"",timeReference:[0,0],version:0,UMID:"",loudnessValue:0,loudnessRange:0,maxTruePeakLevel:0,maxMomentaryLoudness:0,maxShortTermLoudness:0,reserved:"",codingHistory:""},this.iXML={chunkId:"",chunkSize:0,value:""},this.ds64={chunkId:"",chunkSize:0,riffSizeHigh:0,riffSizeLow:0,dataSizeHigh:0,dataSizeLow:0,originationTime:0,sampleCountHigh:0,sampleCountLow:0},this.data={chunkId:"",chunkSize:0,samples:new Uint8Array(0)},this.LIST=[],this.junk={chunkId:"",chunkSize:0,chunkData:[]},this._PMX={chunkId:"",chunkSize:0,value:""},this.uInt16={bits:16,be:!1,signed:!1,fp:!1}}fromBuffer(t,e=!0){if(this.clearHeaders(),this.setSignature(t),this.uInt16.be=this.uInt32.be,this.format!="WAVE")throw Error('Could not find the "WAVE" format identifier');this.readDs64Chunk_(t),this.readFmtChunk_(t),this.readFactChunk_(t),this.readBextChunk_(t),this.readiXMLChunk_(t),this.readCueChunk_(t),this.readSmplChunk_(t),this.readDataChunk_(t,e),this.readJunkChunk_(t),this.readLISTChunk_(t),this.read_PMXChunk_(t)}clearHeaders(){let t=new tt;Object.assign(this.fmt,t.fmt),Object.assign(this.fact,t.fact),Object.assign(this.cue,t.cue),Object.assign(this.smpl,t.smpl),Object.assign(this.bext,t.bext),Object.assign(this.iXML,t.iXML),Object.assign(this.ds64,t.ds64),Object.assign(this.data,t.data),this.LIST=[],Object.assign(this.junk,t.junk),Object.assign(this._PMX,t._PMX)}readFmtChunk_(t){let e=this.findChunk("fmt ");if(e)this.head=e.chunkData.start,this.fmt.chunkId=e.chunkId,this.fmt.chunkSize=e.chunkSize,this.fmt.audioFormat=this.readUInt16_(t),this.fmt.numChannels=this.readUInt16_(t),this.fmt.sampleRate=this.readUInt32(t),this.fmt.byteRate=this.readUInt32(t),this.fmt.blockAlign=this.readUInt16_(t),this.fmt.bitsPerSample=this.readUInt16_(t),this.readFmtExtension_(t);else throw Error('Could not find the "fmt " chunk')}readFmtExtension_(t){this.fmt.chunkSize>16&&(this.fmt.cbSize=this.readUInt16_(t),this.fmt.chunkSize>18&&(this.fmt.validBitsPerSample=this.readUInt16_(t),this.fmt.chunkSize>20&&(this.fmt.dwChannelMask=this.readUInt32(t),this.fmt.subformat=[this.readUInt32(t),this.readUInt32(t),this.readUInt32(t),this.readUInt32(t)])))}readFactChunk_(t){let e=this.findChunk("fact");e&&(this.head=e.chunkData.start,this.fact.chunkId=e.chunkId,this.fact.chunkSize=e.chunkSize,this.fact.dwSampleLength=this.readUInt32(t))}readCueChunk_(t){let e=this.findChunk("cue ");if(e){this.head=e.chunkData.start,this.cue.chunkId=e.chunkId,this.cue.chunkSize=e.chunkSize,this.cue.dwCuePoints=this.readUInt32(t);for(let n=0;n<this.cue.dwCuePoints;n++)this.cue.points.push({dwName:this.readUInt32(t),dwPosition:this.readUInt32(t),fccChunk:this.readString(t,4),dwChunkStart:this.readUInt32(t),dwBlockStart:this.readUInt32(t),dwSampleOffset:this.readUInt32(t)})}}readSmplChunk_(t){let e=this.findChunk("smpl");if(e){this.head=e.chunkData.start,this.smpl.chunkId=e.chunkId,this.smpl.chunkSize=e.chunkSize,this.smpl.dwManufacturer=this.readUInt32(t),this.smpl.dwProduct=this.readUInt32(t),this.smpl.dwSamplePeriod=this.readUInt32(t),this.smpl.dwMIDIUnityNote=this.readUInt32(t),this.smpl.dwMIDIPitchFraction=this.readUInt32(t),this.smpl.dwSMPTEFormat=this.readUInt32(t),this.smpl.dwSMPTEOffset=this.readUInt32(t),this.smpl.dwNumSampleLoops=this.readUInt32(t),this.smpl.dwSamplerData=this.readUInt32(t);for(let n=0;n<this.smpl.dwNumSampleLoops;n++)this.smpl.loops.push({dwName:this.readUInt32(t),dwType:this.readUInt32(t),dwStart:this.readUInt32(t),dwEnd:this.readUInt32(t),dwFraction:this.readUInt32(t),dwPlayCount:this.readUInt32(t)})}}readDataChunk_(t,e){let n=this.findChunk("data");if(n)this.data.chunkId="data",this.data.chunkSize=n.chunkSize,e&&(this.data.samples=t.slice(n.chunkData.start,n.chunkData.end));else throw Error('Could not find the "data" chunk')}readBextChunk_(t){let e=this.findChunk("bext");e&&(this.head=e.chunkData.start,this.bext.chunkId=e.chunkId,this.bext.chunkSize=e.chunkSize,this.bext.description=this.readString(t,256),this.bext.originator=this.readString(t,32),this.bext.originatorReference=this.readString(t,32),this.bext.originationDate=this.readString(t,10),this.bext.originationTime=this.readString(t,8),this.bext.timeReference=[this.readUInt32(t),this.readUInt32(t)],this.bext.version=this.readUInt16_(t),this.bext.UMID=this.readString(t,64),this.bext.loudnessValue=this.readUInt16_(t),this.bext.loudnessRange=this.readUInt16_(t),this.bext.maxTruePeakLevel=this.readUInt16_(t),this.bext.maxMomentaryLoudness=this.readUInt16_(t),this.bext.maxShortTermLoudness=this.readUInt16_(t),this.bext.reserved=this.readString(t,180),this.bext.codingHistory=this.readString(t,this.bext.chunkSize-602))}readiXMLChunk_(t){let e=this.findChunk("iXML");e&&(this.head=e.chunkData.start,this.iXML.chunkId=e.chunkId,this.iXML.chunkSize=e.chunkSize,this.iXML.value=E(t,this.head,this.head+this.iXML.chunkSize))}readDs64Chunk_(t){let e=this.findChunk("ds64");if(e)this.head=e.chunkData.start,this.ds64.chunkId=e.chunkId,this.ds64.chunkSize=e.chunkSize,this.ds64.riffSizeHigh=this.readUInt32(t),this.ds64.riffSizeLow=this.readUInt32(t),this.ds64.dataSizeHigh=this.readUInt32(t),this.ds64.dataSizeLow=this.readUInt32(t),this.ds64.originationTime=this.readUInt32(t),this.ds64.sampleCountHigh=this.readUInt32(t),this.ds64.sampleCountLow=this.readUInt32(t);else if(this.container=="RF64")throw Error('Could not find the "ds64" chunk')}readLISTChunk_(t){let e=this.findChunk("LIST",!0);if(e!==null)for(let n=0;n<e.length;n++){let s=e[n];this.LIST.push({chunkId:s.chunkId,chunkSize:s.chunkSize,format:s.format,subChunks:[]});for(let r=0;r<s.subChunks.length;r++)this.readLISTSubChunks_(s.subChunks[r],s.format,t)}}readLISTSubChunks_(t,e,n){e=="adtl"?["labl","note","ltxt"].indexOf(t.chunkId)>-1&&this.readLISTadtlSubChunks_(n,t):e=="INFO"&&this.readLISTINFOSubChunks_(n,t)}readLISTadtlSubChunks_(t,e){this.head=e.chunkData.start;let n={chunkId:e.chunkId,chunkSize:e.chunkSize,dwName:this.readUInt32(t)};e.chunkId=="ltxt"?(n.dwSampleLength=this.readUInt32(t),n.dwPurposeID=this.readUInt32(t),n.dwCountry=this.readUInt16_(t),n.dwLanguage=this.readUInt16_(t),n.dwDialect=this.readUInt16_(t),n.dwCodePage=this.readUInt16_(t),n.value=""):n.value=this.readZSTR_(t,this.head),this.LIST[this.LIST.length-1].subChunks.push(n)}readLISTINFOSubChunks_(t,e){this.head=e.chunkData.start,this.LIST[this.LIST.length-1].subChunks.push({chunkId:e.chunkId,chunkSize:e.chunkSize,value:this.readZSTR_(t,this.head)})}readJunkChunk_(t){let e=this.findChunk("junk");e&&(this.junk={chunkId:e.chunkId,chunkSize:e.chunkSize,chunkData:[].slice.call(t.slice(e.chunkData.start,e.chunkData.end))})}read_PMXChunk_(t){let e=this.findChunk("_PMX");e&&(this.head=e.chunkData.start,this._PMX.chunkId=e.chunkId,this._PMX.chunkSize=e.chunkSize,this._PMX.value=E(t,this.head,this.head+this._PMX.chunkSize))}readZSTR_(t,e=0){for(let n=e;n<t.length&&(this.head++,t[n]!==0);n++);return E(t,e,this.head-1)}readUInt16_(t){let e=W(t,this.uInt16,this.head);return this.head+=2,e}}function L(i,t){let e=p(i);for(let n=e.length;n<t;n++)e.push(0);return e}class he extends tt{toBuffer(){this.uInt16.be=this.container==="RIFX",this.uInt32.be=this.uInt16.be;let t=[this.getJunkBytes_(),this.getDs64Bytes_(),this.getBextBytes_(),this.getiXMLBytes_(),this.getFmtBytes_(),this.getFactBytes_(),p(this.data.chunkId),a(this.data.samples.length,this.uInt32),this.data.samples,this.getCueBytes_(),this.getSmplBytes_(),this.getLISTBytes_(),this.get_PMXBytes_()],e=0;for(let r=0;r<t.length;r++)e+=t[r].length;let n=new Uint8Array(e+12),s=0;s=ht(this.container,n,s),s=Y(e+4,this.uInt32,n,s),s=ht(this.format,n,s);for(let r=0;r<t.length;r++)n.set(t[r],s),s+=t[r].length;return n}getBextBytes_(){let t=[];return this.enforceBext_(),this.bext.chunkId&&(this.bext.chunkSize=602+this.bext.codingHistory.length,t=t.concat(p(this.bext.chunkId),a(602+this.bext.codingHistory.length,this.uInt32),L(this.bext.description,256),L(this.bext.originator,32),L(this.bext.originatorReference,32),L(this.bext.originationDate,10),L(this.bext.originationTime,8),a(this.bext.timeReference[0],this.uInt32),a(this.bext.timeReference[1],this.uInt32),a(this.bext.version,this.uInt16),L(this.bext.UMID,64),a(this.bext.loudnessValue,this.uInt16),a(this.bext.loudnessRange,this.uInt16),a(this.bext.maxTruePeakLevel,this.uInt16),a(this.bext.maxMomentaryLoudness,this.uInt16),a(this.bext.maxShortTermLoudness,this.uInt16),L(this.bext.reserved,180),L(this.bext.codingHistory,this.bext.codingHistory.length))),this.enforceByteLen_(t),t}enforceBext_(){for(let t in this.bext)if(this.bext.hasOwnProperty(t)&&this.bext[t]&&t!="timeReference"){this.bext.chunkId="bext";break}(this.bext.timeReference[0]||this.bext.timeReference[1])&&(this.bext.chunkId="bext")}getiXMLBytes_(){let t=[];if(this.iXML.chunkId){let e=p(this.iXML.value);this.iXML.chunkSize=e.length,t=t.concat(p(this.iXML.chunkId),a(this.iXML.chunkSize,this.uInt32),e)}return this.enforceByteLen_(t),t}getDs64Bytes_(){let t=[];return this.ds64.chunkId&&(t=t.concat(p(this.ds64.chunkId),a(this.ds64.chunkSize,this.uInt32),a(this.ds64.riffSizeHigh,this.uInt32),a(this.ds64.riffSizeLow,this.uInt32),a(this.ds64.dataSizeHigh,this.uInt32),a(this.ds64.dataSizeLow,this.uInt32),a(this.ds64.originationTime,this.uInt32),a(this.ds64.sampleCountHigh,this.uInt32),a(this.ds64.sampleCountLow,this.uInt32))),this.enforceByteLen_(t),t}getCueBytes_(){let t=[];if(this.cue.chunkId){let e=this.getCuePointsBytes_();t=t.concat(p(this.cue.chunkId),a(e.length+4,this.uInt32),a(this.cue.dwCuePoints,this.uInt32),e)}return this.enforceByteLen_(t),t}getCuePointsBytes_(){let t=[];for(let e=0;e<this.cue.dwCuePoints;e++)t=t.concat(a(this.cue.points[e].dwName,this.uInt32),a(this.cue.points[e].dwPosition,this.uInt32),p(this.cue.points[e].fccChunk),a(this.cue.points[e].dwChunkStart,this.uInt32),a(this.cue.points[e].dwBlockStart,this.uInt32),a(this.cue.points[e].dwSampleOffset,this.uInt32));return t}getSmplBytes_(){let t=[];if(this.smpl.chunkId){let e=this.getSmplLoopsBytes_();t=t.concat(p(this.smpl.chunkId),a(e.length+36,this.uInt32),a(this.smpl.dwManufacturer,this.uInt32),a(this.smpl.dwProduct,this.uInt32),a(this.smpl.dwSamplePeriod,this.uInt32),a(this.smpl.dwMIDIUnityNote,this.uInt32),a(this.smpl.dwMIDIPitchFraction,this.uInt32),a(this.smpl.dwSMPTEFormat,this.uInt32),a(this.smpl.dwSMPTEOffset,this.uInt32),a(this.smpl.dwNumSampleLoops,this.uInt32),a(this.smpl.dwSamplerData,this.uInt32),e)}return this.enforceByteLen_(t),t}getSmplLoopsBytes_(){let t=[];for(let e=0;e<this.smpl.dwNumSampleLoops;e++)t=t.concat(a(this.smpl.loops[e].dwName,this.uInt32),a(this.smpl.loops[e].dwType,this.uInt32),a(this.smpl.loops[e].dwStart,this.uInt32),a(this.smpl.loops[e].dwEnd,this.uInt32),a(this.smpl.loops[e].dwFraction,this.uInt32),a(this.smpl.loops[e].dwPlayCount,this.uInt32));return t}getFactBytes_(){let t=[];return this.fact.chunkId&&(t=t.concat(p(this.fact.chunkId),a(this.fact.chunkSize,this.uInt32),a(this.fact.dwSampleLength,this.uInt32))),this.enforceByteLen_(t),t}getFmtBytes_(){let t=[];if(this.fmt.chunkId){let e=t.concat(p(this.fmt.chunkId),a(this.fmt.chunkSize,this.uInt32),a(this.fmt.audioFormat,this.uInt16),a(this.fmt.numChannels,this.uInt16),a(this.fmt.sampleRate,this.uInt32),a(this.fmt.byteRate,this.uInt32),a(this.fmt.blockAlign,this.uInt16),a(this.fmt.bitsPerSample,this.uInt16),this.getFmtExtensionBytes_());return this.enforceByteLen_(e),e}throw Error('Could not find the "fmt " chunk')}getFmtExtensionBytes_(){let t=[];return this.fmt.chunkSize>16&&(t=t.concat(a(this.fmt.cbSize,this.uInt16))),this.fmt.chunkSize>18&&(t=t.concat(a(this.fmt.validBitsPerSample,this.uInt16))),this.fmt.chunkSize>20&&(t=t.concat(a(this.fmt.dwChannelMask,this.uInt32))),this.fmt.chunkSize>24&&(t=t.concat(a(this.fmt.subformat[0],this.uInt32),a(this.fmt.subformat[1],this.uInt32),a(this.fmt.subformat[2],this.uInt32),a(this.fmt.subformat[3],this.uInt32))),t}getLISTBytes_(){let t=[];for(let e=0;e<this.LIST.length;e++){let n=this.getLISTSubChunksBytes_(this.LIST[e].subChunks,this.LIST[e].format);t=t.concat(p(this.LIST[e].chunkId),a(n.length+4,this.uInt32),p(this.LIST[e].format),n)}return this.enforceByteLen_(t),t}getLISTSubChunksBytes_(t,e){let n=[];for(let s=0,r=t.length;s<r;s++)e=="INFO"?n=n.concat(this.getLISTINFOSubChunksBytes_(t[s])):e=="adtl"&&(n=n.concat(this.getLISTadtlSubChunksBytes_(t[s]))),this.enforceByteLen_(n);return n}getLISTINFOSubChunksBytes_(t){let e=[],n=L(t.value,t.value.length);return e=e.concat(p(t.chunkId),a(n.length+1,this.uInt32),n),e.push(0),e}getLISTadtlSubChunksBytes_(t){let e=[];if(["labl","note"].indexOf(t.chunkId)>-1){let n=L(t.value,t.value.length);e=e.concat(p(t.chunkId),a(n.length+4+1,this.uInt32),a(t.dwName,this.uInt32),n),e.push(0)}else t.chunkId=="ltxt"&&(e=e.concat(this.getLtxtChunkBytes_(t)));return e}getLtxtChunkBytes_(t){return[].concat(p(t.chunkId),a(t.value.length+20,this.uInt32),a(t.dwName,this.uInt32),a(t.dwSampleLength,this.uInt32),a(t.dwPurposeID,this.uInt32),a(t.dwCountry,this.uInt16),a(t.dwLanguage,this.uInt16),a(t.dwDialect,this.uInt16),a(t.dwCodePage,this.uInt16),L(t.value,t.value.length))}get_PMXBytes_(){let t=[];if(this._PMX.chunkId){let e=p(this._PMX.value);this._PMX.chunkSize=e.length,t=t.concat(p(this._PMX.chunkId),a(this._PMX.chunkSize,this.uInt32),e)}return this.enforceByteLen_(t),t}getJunkBytes_(){let t=[];return this.junk.chunkId?t.concat(p(this.junk.chunkId),a(this.junk.chunkData.length,this.uInt32),this.junk.chunkData):(this.enforceByteLen_(t),t)}enforceByteLen_(t){t.length%2&&t.push(0)}}function ae(i){let t=[];if(i.length>0)if(i[0].constructor!==Number){t=new Float64Array(i[0].length*i.length);for(let e=0,n=i[0].length,s=0;e<n;e++)for(let r=0,h=i.length;r<h;r++,s++)t[s]=i[r][e]}else t=i;return t}function oe(i,t,e=Float64Array){let n=[];for(let s=0;s<t;s++)n[s]=new e(i.length/t);for(let s=0;s<t;s++)for(let r=s,h=0;r<i.length;r+=t,h++)n[s][h]=i[r];return n}function le(i,t){let e=i*t/8;return!(i<1||e>65535)}function mt(i,t,e){let n=i*(t/8)*e;return!(e<1||n>4294967295)}class ce extends he{constructor(){super(),this.bitDepth="0",this.dataType={bits:0,be:!1},this.WAV_AUDIO_FORMATS={4:17,8:1,"8a":6,"8m":7,16:1,24:1,32:1,"32f":3,64:3}}fromScratch(t,e,n,s,r){r=r||{},this.clearHeaders(),this.newWavFile_(t,e,n,s,r)}fromBuffer(t,e=!0){super.fromBuffer(t,e),this.bitDepthFromFmt_(),this.updateDataType_()}toBuffer(){return this.validateWavHeader_(),super.toBuffer()}getSamples(t=!1,e=Float64Array){let n=new e(this.data.samples.length/(this.dataType.bits/8));return z(this.data.samples,this.dataType,n,0,this.data.samples.length),!t&&this.fmt.numChannels>1?oe(n,this.fmt.numChannels,e):n}getSample(t){if(t=t*(this.dataType.bits/8),t+this.dataType.bits/8>this.data.samples.length)throw new Error("Range error");return W(this.data.samples.slice(t,t+this.dataType.bits/8),this.dataType)}setSample(t,e){if(t=t*(this.dataType.bits/8),t+this.dataType.bits/8>this.data.samples.length)throw new Error("Range error");Y(e,this.dataType,this.data.samples,t)}getiXML(){return this.iXML.value}setiXML(t){if(typeof t!="string")throw new TypeError("iXML value must be a string.");this.iXML.value=t,this.iXML.chunkId="iXML"}get_PMX(){return this._PMX.value}set_PMX(t){if(typeof t!="string")throw new TypeError("_PMX value must be a string.");this._PMX.value=t,this._PMX.chunkId="_PMX"}newWavFile_(t,e,n,s,r){r.container||(r.container="RIFF"),this.container=r.container,this.bitDepth=n,s=ae(s),this.updateDataType_();let h=this.dataType.bits/8;this.data.samples=new Uint8Array(s.length*h),gt(s,this.dataType,this.data.samples,0),this.makeWavHeader_(n,t,e,h,this.data.samples.length,r),this.data.chunkId="data",this.data.chunkSize=this.data.samples.length,this.validateWavHeader_()}makeWavHeader_(t,e,n,s,r,h){t=="4"?this.createADPCMHeader_(t,e,n,s,r,h):t=="8a"||t=="8m"?this.createALawMulawHeader_(t,e,n,s,r,h):Object.keys(this.WAV_AUDIO_FORMATS).indexOf(t)==-1||e>2?this.createExtensibleHeader_(t,e,n,s,r,h):this.createPCMHeader_(t,e,n,s,r,h)}createPCMHeader_(t,e,n,s,r,h){this.container=h.container,this.chunkSize=36+r,this.format="WAVE",this.bitDepth=t,this.fmt={chunkId:"fmt ",chunkSize:16,audioFormat:this.WAV_AUDIO_FORMATS[t]||65534,numChannels:e,sampleRate:n,byteRate:e*s*n,blockAlign:e*s,bitsPerSample:parseInt(t,10),cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]}}createADPCMHeader_(t,e,n,s,r,h){this.createPCMHeader_(t,e,n,s,r,h),this.chunkSize=40+r,this.fmt.chunkSize=20,this.fmt.byteRate=4055,this.fmt.blockAlign=256,this.fmt.bitsPerSample=4,this.fmt.cbSize=2,this.fmt.validBitsPerSample=505,this.fact={chunkId:"fact",chunkSize:4,dwSampleLength:r*2}}createExtensibleHeader_(t,e,n,s,r,h){this.createPCMHeader_(t,e,n,s,r,h),this.chunkSize=36+24+r,this.fmt.chunkSize=40,this.fmt.bitsPerSample=(parseInt(t,10)-1|7)+1,this.fmt.cbSize=22,this.fmt.validBitsPerSample=parseInt(t,10),this.fmt.dwChannelMask=ue(e),this.fmt.subformat=[1,1048576,2852126848,1905997824]}createALawMulawHeader_(t,e,n,s,r,h){this.createPCMHeader_(t,e,n,s,r,h),this.chunkSize=40+r,this.fmt.chunkSize=20,this.fmt.cbSize=2,this.fmt.validBitsPerSample=8,this.fact={chunkId:"fact",chunkSize:4,dwSampleLength:r}}bitDepthFromFmt_(){this.fmt.audioFormat===3&&this.fmt.bitsPerSample===32?this.bitDepth="32f":this.fmt.audioFormat===6?this.bitDepth="8a":this.fmt.audioFormat===7?this.bitDepth="8m":this.bitDepth=this.fmt.bitsPerSample.toString()}validateBitDepth_(){if(!this.WAV_AUDIO_FORMATS[this.bitDepth]){if(parseInt(this.bitDepth,10)>8&&parseInt(this.bitDepth,10)<54)return!0;throw new Error("Invalid bit depth.")}return!0}updateDataType_(){this.dataType={bits:(parseInt(this.bitDepth,10)-1|7)+1,fp:this.bitDepth=="32f"||this.bitDepth=="64",signed:this.bitDepth!="8",be:this.container=="RIFX"},["4","8a","8m"].indexOf(this.bitDepth)>-1&&(this.dataType.bits=8,this.dataType.signed=!1)}validateWavHeader_(){if(this.validateBitDepth_(),!le(this.fmt.numChannels,this.fmt.bitsPerSample))throw new Error("Invalid number of channels.");if(!mt(this.fmt.numChannels,this.fmt.bitsPerSample,this.fmt.sampleRate))throw new Error("Invalid sample rate.")}}function ue(i){let t=0;return i===1?t=4:i===2?t=3:i===4?t=51:i===6?t=63:i===8&&(t=1599),t}class de extends ce{getTag(t){let e=this.getTagIndex_(t);return e.TAG!==null?this.LIST[e.LIST].subChunks[e.TAG].value:null}setTag(t,e){t=fe(t);let n=this.getTagIndex_(t);n.TAG!==null?(this.LIST[n.LIST].subChunks[n.TAG].chunkSize=e.length+1,this.LIST[n.LIST].subChunks[n.TAG].value=e):n.LIST!==null?this.LIST[n.LIST].subChunks.push({chunkId:t,chunkSize:e.length+1,value:e}):(this.LIST.push({chunkId:"LIST",chunkSize:8+e.length+1,format:"INFO",subChunks:[]}),this.LIST[this.LIST.length-1].subChunks.push({chunkId:t,chunkSize:e.length+1,value:e}))}deleteTag(t){let e=this.getTagIndex_(t);return e.TAG!==null?(this.LIST[e.LIST].subChunks.splice(e.TAG,1),!0):!1}listTags(){let t=this.getLISTIndex("INFO"),e={};if(t!==null)for(let n=0,s=this.LIST[t].subChunks.length;n<s;n++)e[this.LIST[t].subChunks[n].chunkId]=this.LIST[t].subChunks[n].value;return e}getLISTIndex(t){for(let e=0,n=this.LIST.length;e<n;e++)if(this.LIST[e].format==t)return e;return null}getTagIndex_(t){let e={LIST:null,TAG:null};for(let n=0,s=this.LIST.length;n<s;n++)if(this.LIST[n].format=="INFO"){e.LIST=n;for(let r=0,h=this.LIST[n].subChunks.length;r<h;r++)if(this.LIST[n].subChunks[r].chunkId==t){e.TAG=r;break}break}return e}}function fe(i){if(i.constructor!==String)throw new Error("Invalid tag name.");if(i.length<4)for(let t=0,e=4-i.length;t<e;t++)i+=" ";return i}class ot extends de{listCuePoints(){let t=this.getCuePoints_();for(let e=0,n=t.length;e<n;e++)t[e].position=t[e].dwSampleOffset/this.fmt.sampleRate*1e3,t[e].dwSampleLength?(t[e].end=t[e].dwSampleLength/this.fmt.sampleRate*1e3,t[e].end+=t[e].position):t[e].end=null,delete t[e].value;return t}setCuePoint(t){this.cue.chunkId="cue ",t.label||(t.label="");let e=this.getCuePoints_();this.clearLISTadtl_(),this.cue.points=[],t.dwSampleOffset=t.position*this.fmt.sampleRate/1e3,t.dwSampleLength=0,t.end&&(t.dwSampleLength=t.end*this.fmt.sampleRate/1e3-t.dwSampleOffset),e.length===0?this.setCuePoint_(t,1):this.setCuePointInOrder_(e,t),this.cue.dwCuePoints=this.cue.points.length}deleteCuePoint(t){this.cue.chunkId="cue ";let e=this.getCuePoints_();this.clearLISTadtl_();let n=this.cue.points.length;this.cue.points=[];for(let s=0;s<n;s++)s+1!==t&&this.setCuePoint_(e[s],s+1);this.cue.dwCuePoints=this.cue.points.length,this.cue.dwCuePoints?this.cue.chunkId="cue ":(this.cue.chunkId="",this.clearLISTadtl_())}updateLabel(t,e){let n=this.getLISTIndex("adtl");if(n!==null)for(let s=0,r=this.LIST[n].subChunks.length;s<r;s++)this.LIST[n].subChunks[s].dwName==t&&(this.LIST[n].subChunks[s].value=e)}getCuePoints_(){let t=[];for(let e=0;e<this.cue.points.length;e++){let n=this.cue.points[e],s=this.getDataForCuePoint_(n.dwName);s.label=s.value?s.value:"",s.dwPosition=n.dwPosition,s.fccChunk=n.fccChunk,s.dwChunkStart=n.dwChunkStart,s.dwBlockStart=n.dwBlockStart,s.dwSampleOffset=n.dwSampleOffset,t.push(s)}return t}getDataForCuePoint_(t){let e=this.getLISTIndex("adtl"),n={};return e!==null&&this.getCueDataFromLIST_(n,e,t),n}getCueDataFromLIST_(t,e,n){for(let s=0,r=this.LIST[e].subChunks.length;s<r;s++)if(this.LIST[e].subChunks[s].dwName==n){let h=this.LIST[e].subChunks[s];t.value=h.value||t.value,t.dwName=h.dwName||0,t.dwSampleLength=h.dwSampleLength||0,t.dwPurposeID=h.dwPurposeID||0,t.dwCountry=h.dwCountry||0,t.dwLanguage=h.dwLanguage||0,t.dwDialect=h.dwDialect||0,t.dwCodePage=h.dwCodePage||0}}setCuePoint_(t,e){this.cue.points.push({dwName:e,dwPosition:t.dwPosition?t.dwPosition:0,fccChunk:t.fccChunk?t.fccChunk:"data",dwChunkStart:t.dwChunkStart?t.dwChunkStart:0,dwBlockStart:t.dwBlockStart?t.dwBlockStart:0,dwSampleOffset:t.dwSampleOffset}),this.setLabl_(t,e)}setCuePointInOrder_(t,e){let n=!1;for(let s=0;s<t.length;s++)t[s].dwSampleOffset>e.dwSampleOffset&&!n?(this.setCuePoint_(e,s+1),this.setCuePoint_(t[s],s+2),n=!0):this.setCuePoint_(t[s],n?s+2:s+1);n||this.setCuePoint_(e,this.cue.points.length+1)}clearLISTadtl_(){for(let t=0,e=this.LIST.length;t<e;t++)this.LIST[t].format=="adtl"&&this.LIST.splice(t)}setLabl_(t,e){let n=this.getLISTIndex("adtl");n===null&&(this.LIST.push({chunkId:"LIST",chunkSize:4,format:"adtl",subChunks:[]}),n=this.LIST.length-1),this.setLabelText_(n,t,e),t.dwSampleLength&&this.setLtxtChunk_(n,t,e)}setLabelText_(t,e,n){this.LIST[t].subChunks.push({chunkId:"labl",chunkSize:4,dwName:n,value:e.label}),this.LIST[t].chunkSize+=12}setLtxtChunk_(t,e,n){this.LIST[t].subChunks.push({chunkId:"ltxt",chunkSize:20,dwName:n,dwSampleLength:e.dwSampleLength,dwPurposeID:e.dwPurposeID||0,dwCountry:e.dwCountry||0,dwLanguage:e.dwLanguage||0,dwDialect:e.dwDialect||0,dwCodePage:e.dwCodePage||0,value:e.label}),this.LIST[t].chunkSize+=28}}class ge{constructor(t,e,n){this.length_=t,this.scaleFactor_=(t-1)/e,this.interpolate=this.sinc,n.method==="point"?this.interpolate=this.point:n.method==="linear"?this.interpolate=this.linear:n.method==="cubic"&&(this.interpolate=this.cubic),this.tangentFactor_=1-Math.max(0,Math.min(1,n.tension||0)),this.sincFilterSize_=n.sincFilterSize||1,this.kernel_=me(n.sincWindow||_e)}point(t,e){return this.getClippedInput_(Math.round(this.scaleFactor_*t),e)}linear(t,e){t=this.scaleFactor_*t;let n=Math.floor(t);return t-=n,(1-t)*this.getClippedInput_(n,e)+t*this.getClippedInput_(n+1,e)}cubic(t,e){t=this.scaleFactor_*t;let n=Math.floor(t),s=[this.getTangent_(n,e),this.getTangent_(n+1,e)],r=[this.getClippedInput_(n,e),this.getClippedInput_(n+1,e)];t-=n;let h=t*t,o=t*h;return(2*o-3*h+1)*r[0]+(o-2*h+t)*s[0]+(-2*o+3*h)*r[1]+(o-h)*s[1]}sinc(t,e){t=this.scaleFactor_*t;let n=Math.floor(t),s=n-this.sincFilterSize_+1,r=n+this.sincFilterSize_,h=0;for(let o=s;o<=r;o++)h+=this.kernel_(t-o)*this.getClippedInput_(o,e);return h}getTangent_(t,e){return this.tangentFactor_*(this.getClippedInput_(t+1,e)-this.getClippedInput_(t-1,e))/2}getClippedInput_(t,e){return 0<=t&&t<this.length_?e[t]:0}}function _e(i){return Math.exp(-i/2*i/2)}function me(i){return function(t){return pe(t)*i(t)}}function pe(i){return i===0?1:Math.sin(Math.PI*i)/(Math.PI*i)}class we{constructor(t,e,n){let s=2*Math.PI*n/e,r=0;this.filters=[];for(let h=0;h<=t;h++)h-t/2===0?this.filters[h]=s:(this.filters[h]=Math.sin(s*(h-t/2))/(h-t/2),this.filters[h]*=.54-.46*Math.cos(2*Math.PI*h/t)),r=r+this.filters[h];for(let h=0;h<=t;h++)this.filters[h]/=r;this.z=this.initZ_()}filter(t){this.z.buf[this.z.pointer]=t;let e=0;for(let n=0,s=this.z.buf.length;n<s;n++)e+=this.filters[n]*this.z.buf[(this.z.pointer+n)%this.z.buf.length];return this.z.pointer=(this.z.pointer+1)%this.z.buf.length,e}reset(){this.z=this.initZ_()}initZ_(){let t=[];for(let e=0;e<this.filters.length-1;e++)t.push(0);return{buf:t,pointer:0}}}class Ie{constructor(t,e,n){let s=[];for(let r=0;r<t;r++)s.push(this.getCoeffs_({Fs:e,Fc:n,Q:.5/Math.sin(Math.PI/(t*2)*(r+.5))}));this.stages=[];for(let r=0;r<s.length;r++)this.stages[r]={b0:s[r].b[0],b1:s[r].b[1],b2:s[r].b[2],a1:s[r].a[0],a2:s[r].a[1],k:s[r].k,z:[0,0]}}filter(t){let e=t;for(let n=0,s=this.stages.length;n<s;n++)e=this.runStage_(n,e);return e}getCoeffs_(t){let e={};e.a=[],e.b=[];let n=this.preCalc_(t,e);return e.k=1,e.b.push((1-n.cw)/(2*n.a0)),e.b.push(2*e.b[0]),e.b.push(e.b[0]),e}preCalc_(t,e){let n={},s=2*Math.PI*t.Fc/t.Fs;return n.alpha=Math.sin(s)/(2*t.Q),n.cw=Math.cos(s),n.a0=1+n.alpha,e.a0=n.a0,e.a.push(-2*n.cw/n.a0),e.k=1,e.a.push((1-n.alpha)/n.a0),n}runStage_(t,e){let n=e*this.stages[t].k-this.stages[t].a1*this.stages[t].z[0]-this.stages[t].a2*this.stages[t].z[1],s=this.stages[t].b0*n+this.stages[t].b1*this.stages[t].z[0]+this.stages[t].b2*this.stages[t].z[1];return this.stages[t].z[1]=this.stages[t].z[0],this.stages[t].z[0]=n,s}reset(){for(let t=0;t<this.stages.length;t++)this.stages[t].z=[0,0]}}const ke={point:!1,linear:!1,cubic:!0,sinc:!0},lt={IIR:16,FIR:71},Se={IIR:Ie,FIR:we};function ct(i,t,e,n=null){n=n||{};let s=(e-t)/t+1,r=new Float64Array(i.length*s);n.method=n.method||"cubic";let h=new ge(i.length,r.length,{method:n.method,tension:n.tension||0,sincFilterSize:n.sincFilterSize||6,sincWindow:n.sincWindow||void 0,clip:n.clip||"mirror"});if(n.LPF===void 0&&(n.LPF=ke[n.method]),n.LPF){n.LPFType=n.LPFType||"IIR";const o=Se[n.LPFType];if(e>t){let l=new o(n.LPForder||lt[n.LPFType],e,t/2);be(i,r,h,l)}else{let l=new o(n.LPForder||lt[n.LPFType],t,e/2);ye(i,r,h,l)}}else pt(i,r,h);return r}function pt(i,t,e){for(let n=0,s=t.length;n<s;n++)t[n]=e.interpolate(n,i)}function be(i,t,e,n){for(let s=0,r=t.length;s<r;s++)t[s]=n.filter(e.interpolate(s,i));n.reset();for(let s=t.length-1;s>=0;s--)t[s]=n.filter(t[s])}function ye(i,t,e,n){for(let s=0,r=i.length;s<r;s++)i[s]=n.filter(i[s]);n.reset();for(let s=i.length-1;s>=0;s--)i[s]=n.filter(i[s]);pt(i,t,e)}class Le extends ot{toRIFF(){let t=new Float64Array(O(this.data.samples.length,this.dataType.bits/8));z(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,t,{container:"RIFF"})}toRIFX(){let t=new Float64Array(O(this.data.samples.length,this.dataType.bits/8));z(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,t,{container:"RIFX"})}toIMAADPCM(){if(this.fmt.sampleRate!==8e3)throw new Error("Only 8000 Hz files can be compressed as IMA-ADPCM.");if(this.fmt.numChannels!==1)throw new Error("Only mono files can be compressed as IMA-ADPCM.");{this.assure16Bit_();let t=new Int16Array(O(this.data.samples.length,2));z(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"4",Ut(t),{container:this.correctContainer_()})}}fromIMAADPCM(t="16"){this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"16",Et(this.data.samples,this.fmt.blockAlign),{container:this.correctContainer_()}),t!="16"&&this.toBitDepth(t)}toALaw(){this.assure16Bit_();let t=new Int16Array(O(this.data.samples.length,2));z(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"8a",qt(t),{container:this.correctContainer_()})}fromALaw(t="16"){this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"16",Gt(this.data.samples),{container:this.correctContainer_()}),t!="16"&&this.toBitDepth(t)}toMuLaw(){this.assure16Bit_();let t=new Int16Array(O(this.data.samples.length,2));z(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"8m",Qt(t),{container:this.correctContainer_()})}fromMuLaw(t="16"){this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"16",Yt(this.data.samples),{container:this.correctContainer_()}),t!="16"&&this.toBitDepth(t)}toBitDepth(t,e=!0){let n=t,s=this.bitDepth;e||(t!="32f"&&(n=this.dataType.bits.toString()),s=""+this.dataType.bits),this.assureUncompressed_();let r=this.getSamples(!0),h=new Float64Array(r.length);Mt(r,s,h,n),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,t,h,{container:this.correctContainer_()})}toSampleRate(t,e){this.validateResample_(t);let n=this.getSamples(),s=[];if(n.constructor===Float64Array)s=ct(n,this.fmt.sampleRate,t,e);else for(let r=0;r<n.length;r++)s.push(ct(n[r],this.fmt.sampleRate,t,e));this.fromExisting_(this.fmt.numChannels,t,this.bitDepth,s,{container:this.correctContainer_()})}validateResample_(t){if(mt(this.fmt.numChannels,this.fmt.bitsPerSample,t)){if(["4","8a","8m"].indexOf(this.bitDepth)>-1)throw new Error("wavefile can't change the sample rate of compressed files.")}else throw new Error("Invalid sample rate.")}assure16Bit_(){this.assureUncompressed_(),this.bitDepth!="16"&&this.toBitDepth("16")}assureUncompressed_(){this.bitDepth=="8a"?this.fromALaw():this.bitDepth=="8m"?this.fromMuLaw():this.bitDepth=="4"&&this.fromIMAADPCM()}correctContainer_(){return this.container=="RF64"?"RIFF":this.container}fromExisting_(t,e,n,s,r){let h=new ot;Object.assign(this.fmt,h.fmt),Object.assign(this.fact,h.fact),Object.assign(this.ds64,h.ds64),Object.assign(this.data,h.data),this.newWavFile_(t,e,n,s,r)}}function O(i,t){let e=i/t;return e%2&&e++,e}class wt extends Le{constructor(t){super(),t&&this.fromBuffer(t)}fromBase64(t){this.fromBuffer(Ft(t))}toBase64(){return Tt(this.toBuffer())}toDataURI(){return"data:audio/wav;base64,"+this.toBase64()}fromDataURI(t){this.fromBase64(t.replace("data:audio/wav;base64,",""))}}class Ce{constructor(t){P(this,"sampleRate");P(this,"gain",1);P(this,"gainNode");P(this,"stream");P(this,"chunks",[]);P(this,"processor");P(this,"recording",!1);this.audioContext=t,this.sampleRate=t.sampleRate}setGain(t){this.gain=t}async start(){if(this.recording)throw new Error("Already recording");this.recording=!0,await this.audioContext.resume(),this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.gainNode=new GainNode(this.audioContext),this.gainNode.gain.value=this.gain,this.audioContext.createMediaStreamSource(this.stream).connect(this.gainNode);let e=null;return this.processor=this.audioContext.createScriptProcessor(4096,1,1),this.processor.addEventListener("audioprocess",({inputBuffer:n})=>{const s=n.getChannelData(0);if(s.length){if(e!=null){if(s.every(r=>r==0))return;e(),e=null}this.chunks.push(new Float32Array(s))}}),this.gainNode.connect(this.processor),this.processor.connect(this.audioContext.destination),new Promise(n=>e=n)}async end(){var e;if(!this.recording)throw new Error("No record");this.recording=!1,(e=this.stream)==null||e.getTracks().forEach(n=>n.stop()),this.gainNode&&this.processor&&(this.gainNode.disconnect(),this.processor.disconnect());const t=this.chunks.reduce((n,s)=>{const r=new Float32Array(n.length+s.length);return r.set(n),r.set(s,n.length),r},new Float32Array);return this.chunks=[],this.createWavFile(t)}createWavFile(t){let e=new wt;return e.fromScratch(1,this.sampleRate,"32f",t),e}}let g;const It=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&It.decode();let D=null;function B(){return(D===null||D.byteLength===0)&&(D=new Uint8Array(g.memory.buffer)),D}function $(i,t){return i=i>>>0,It.decode(B().subarray(i,i+t))}const F=new Array(128).fill(void 0);F.push(void 0,null,!0,!1);let X=F.length;function _(i){X===F.length&&F.push(F.length+1);const t=X;return X=F[t],F[t]=i,t}function f(i){return F[i]}function xe(i){i<132||(F[i]=X,X=i)}function K(i){const t=f(i);return xe(i),t}let A=0;const j=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Te=typeof j.encodeInto=="function"?function(i,t){return j.encodeInto(i,t)}:function(i,t){const e=j.encode(i);return t.set(e),{read:i.length,written:e.length}};function Z(i,t,e){if(e===void 0){const o=j.encode(i),l=t(o.length,1)>>>0;return B().subarray(l,l+o.length).set(o),A=o.length,l}let n=i.length,s=t(n,1)>>>0;const r=B();let h=0;for(;h<n;h++){const o=i.charCodeAt(h);if(o>127)break;r[s+h]=o}if(h!==n){h!==0&&(i=i.slice(h)),s=e(s,n,n=h+i.length*3,1)>>>0;const o=B().subarray(s+h,s+n),l=Te(i,o);h+=l.written}return A=h,s}function Fe(i,t){const e=t(i.length*1,1)>>>0;return B().set(i,e/1),A=i.length,e}let N=null;function H(){return(N===null||N.byteLength===0)&&(N=new Int32Array(g.memory.buffer)),N}function Me(i,t){return i=i>>>0,B().subarray(i/1,i/1+t)}function T(i,t){try{return i.apply(this,t)}catch(e){g.__wbindgen_exn_store(_(e))}}class q{static __wrap(t){t=t>>>0;const e=Object.create(q.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){const t=this.__destroy_into_raw();g.__wbg_wakewordrefcreator_free(t)}static new(t){const e=Z(t,g.__wbindgen_malloc,g.__wbindgen_realloc),n=A,s=g.wakewordrefcreator_new(e,n);return q.__wrap(s)}addFile(t,e){const n=Z(t,g.__wbindgen_malloc,g.__wbindgen_realloc),s=A,r=Fe(e,g.__wbindgen_malloc),h=A;g.wakewordrefcreator_addFile(this.__wbg_ptr,n,s,r,h)}removeFile(t){const e=Z(t,g.__wbindgen_malloc,g.__wbindgen_realloc),n=A;g.wakewordrefcreator_removeFile(this.__wbg_ptr,e,n)}saveToBytes(){try{const h=g.__wbindgen_add_to_stack_pointer(-16);g.wakewordrefcreator_saveToBytes(h,this.__wbg_ptr);var t=H()[h/4+0],e=H()[h/4+1],n=H()[h/4+2],s=H()[h/4+3];if(s)throw K(n);var r=Me(t,e).slice();return g.__wbindgen_free(t,e*1),r}finally{g.__wbindgen_add_to_stack_pointer(16)}}}async function Pe(i,t){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,t)}catch(n){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const e=await i.arrayBuffer();return await WebAssembly.instantiate(e,t)}else{const e=await WebAssembly.instantiate(i,t);return e instanceof WebAssembly.Instance?{instance:e,module:i}:e}}function ve(){const i={};return i.wbg={},i.wbg.__wbindgen_string_new=function(t,e){const n=$(t,e);return _(n)},i.wbg.__wbg_getRandomValues_37fa2ca9e4e07fab=function(){return T(function(t,e){f(t).getRandomValues(f(e))},arguments)},i.wbg.__wbindgen_object_drop_ref=function(t){K(t)},i.wbg.__wbg_randomFillSync_dc1e9a60c158336d=function(){return T(function(t,e){f(t).randomFillSync(K(e))},arguments)},i.wbg.__wbg_crypto_c48a774b022d20ac=function(t){const e=f(t).crypto;return _(e)},i.wbg.__wbindgen_is_object=function(t){const e=f(t);return typeof e=="object"&&e!==null},i.wbg.__wbg_process_298734cf255a885d=function(t){const e=f(t).process;return _(e)},i.wbg.__wbg_versions_e2e78e134e3e5d01=function(t){const e=f(t).versions;return _(e)},i.wbg.__wbg_node_1cd7a5d853dbea79=function(t){const e=f(t).node;return _(e)},i.wbg.__wbindgen_is_string=function(t){return typeof f(t)=="string"},i.wbg.__wbg_msCrypto_bcb970640f50a1e8=function(t){const e=f(t).msCrypto;return _(e)},i.wbg.__wbg_require_8f08ceecec0f4fee=function(){return T(function(){const t=St.require;return _(t)},arguments)},i.wbg.__wbindgen_is_function=function(t){return typeof f(t)=="function"},i.wbg.__wbg_newnoargs_581967eacc0e2604=function(t,e){const n=new Function($(t,e));return _(n)},i.wbg.__wbg_call_cb65541d95d71282=function(){return T(function(t,e){const n=f(t).call(f(e));return _(n)},arguments)},i.wbg.__wbindgen_object_clone_ref=function(t){const e=f(t);return _(e)},i.wbg.__wbg_call_01734de55d61e11d=function(){return T(function(t,e,n){const s=f(t).call(f(e),f(n));return _(s)},arguments)},i.wbg.__wbg_buffer_085ec1f694018c4f=function(t){const e=f(t).buffer;return _(e)},i.wbg.__wbg_self_1ff1d729e9aae938=function(){return T(function(){const t=self.self;return _(t)},arguments)},i.wbg.__wbg_window_5f4faef6c12b79ec=function(){return T(function(){const t=window.window;return _(t)},arguments)},i.wbg.__wbg_globalThis_1d39714405582d3c=function(){return T(function(){const t=globalThis.globalThis;return _(t)},arguments)},i.wbg.__wbg_global_651f05c6a0944d1c=function(){return T(function(){const t=global.global;return _(t)},arguments)},i.wbg.__wbindgen_is_undefined=function(t){return f(t)===void 0},i.wbg.__wbg_newwithbyteoffsetandlength_6da8e527659b86aa=function(t,e,n){const s=new Uint8Array(f(t),e>>>0,n>>>0);return _(s)},i.wbg.__wbg_new_8125e318e6245eed=function(t){const e=new Uint8Array(f(t));return _(e)},i.wbg.__wbg_set_5cf90238115182c3=function(t,e,n){f(t).set(f(e),n>>>0)},i.wbg.__wbg_newwithlength_e5d69174d6984cd7=function(t){const e=new Uint8Array(t>>>0);return _(e)},i.wbg.__wbg_subarray_13db269f57aa838d=function(t,e,n){const s=f(t).subarray(e>>>0,n>>>0);return _(s)},i.wbg.__wbindgen_throw=function(t,e){throw new Error($(t,e))},i.wbg.__wbindgen_memory=function(){const t=g.memory;return _(t)},i}function ze(i,t){return g=i.exports,kt.__wbindgen_wasm_module=t,N=null,D=null,g}async function kt(i){if(g!==void 0)return g;typeof i>"u"&&(i=new URL("/rustpotter-create-model-demo/assets/rustpotter_wasm_bg-0c3f035c.wasm",self.location));const t=ve();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:e,module:n}=await Pe(await i,t);return ze(e,n)}(async()=>{const i="rustpotter@Builder";let t=null,e={recordSupported:!1,recorder:null,records:[],micGain:1,stopSec:null,wakewordName:""};window.addEventListener("load",bt,{once:!0});function n(c){e.micGain=Number(c.target.value)}function s(c){var m;const u=c.target.value,d=Number((m=c.target.value)==null?void 0:m.trim());e.stopSec=u!=null&&u.length&&!isNaN(d)?d:null}function r(c){var u,d;x("loading recorder..."),(u=e.recorder)==null||u.setGain(e.micGain),(d=e.recorder)==null||d.start().then(()=>{x("recording..."),e.stopSec&&(t=setTimeout(h,e.stopSec*1e3)),b("stop")}).catch(function(m){R(m),l()}),b("mic_gain",!1),b("stop_sec",!1),b("build",!1),b("record",!1),b("upload",!1)}function h(){var c;t&&(clearTimeout(t),t=null),b("stop",!1),(c=e.recorder)==null||c.end().then(u=>{let d=new Date().toISOString()+".wav";if(e.wakewordName.length){const m=new Date,y=m.getHours().toString().padStart(2,"0")+"_"+m.getMinutes().toString().padStart(2,"0")+"_"+m.getSeconds().toString().padStart(2,"0");d=`${e.wakewordName.replaceAll(" ","_")}(T${y}).wav`}w(u,d).catch(R)}).catch(u=>{console.error("End record failed: ",u),l()}),x("record finished")}function o(c){var u;e.wakewordName=(u=c.target.value)==null?void 0:u.trim(),l()}function l(){const c=e.records.length<20;b("mic_gain",!0),b("stop_sec",!0),b("record",!!e.wakewordName.length&&e.recordSupported&&c),b("upload",c),b("build",e.wakewordName.length>0&&e.records.length>0)}async function w(c,u){var S;const d=c.toDataURI(),m={name:u,data:c.toBuffer()};e.records.push(m);const y=document.createElement("audio");y.controls=!0,y.src=d;const k=document.createElement("li"),I=document.createElement("a");I.href=d,I.download=u,I.innerHTML=`<img title="Download ${u}" class="img_icon" src="download-icon.svg" alt="download" />`;const M=document.createElement("i");M.innerHTML=`<img title="Remove ${u}" class="img_icon" src="remove-icon.svg" alt="remove" />`,M.onclick=()=>{e.records.splice(e.records.indexOf(m),1),k.remove(),URL.revokeObjectURL(d),l()},k.appendChild(y),k.appendChild(I),k.appendChild(M),(S=document.querySelector("#records"))==null||S.appendChild(k),l()}function v(c){var u;Array.from(((u=c.target)==null?void 0:u.files)??[]).slice(0,6-e.records.length).forEach(d=>{const m=new FileReader;m.onload=function(){const y=this.result;let k=new wt;k.fromBuffer(new Uint8Array(y));const I=d.name;w(k,I).catch(R)},m.onerror=function(){G("Unable to read wakeword file.")},m.readAsArrayBuffer(d)})}async function C(){x("loading rustpotter...");const c=new URL("/rustpotter-create-model-demo/assets/rustpotter_wasm_bg-0c3f035c.wasm",self.location);try{await kt(c);const u=q.new(e.wakewordName);x("generating wakeword model..."),e.records.forEach(({name:M,data:S})=>u.addFile(M,new Uint8Array(S)));const d=u.saveToBytes();x("unloading rustpotter..."),u.free();const m=e.wakewordName.replaceAll(" ","_")+".rpw";x("downloading wakeword model '"+m+"'...");const y=new Blob([d.buffer],{type:"application/octet-stream"}),k=URL.createObjectURL(y),I=document.createElement("a");I.href=k,I.download=m,document.body.appendChild(I),I.setAttribute("style","display: none"),I.click(),I.remove(),x("done"),setTimeout(()=>URL.revokeObjectURL(k),1e4)}catch(u){R(u)}}function bt(){var u,d,m,y,k,I,M;const c=document.querySelector("#rustpotter_version");c&&(c.innerHTML="rustpotter-v3.0.0",c.href="https://github.com/GiviMAD/rustpotter-cli/releases/tag/v3.0.0");try{if(e.recordSupported=yt(),e.recordSupported)e.recorder=new Ce(new AudioContext);else{G("Unable to record on this browser :(");return}(u=document.querySelector("#wakeword_name"))==null||u.addEventListener("input",o),(d=document.querySelector("#mic_gain"))==null||d.addEventListener("input",n),(m=document.querySelector("#stop_sec"))==null||m.addEventListener("input",s),(y=document.querySelector("#record"))==null||y.addEventListener("click",r),(k=document.querySelector("#stop"))==null||k.addEventListener("click",h),(I=document.querySelector("#build"))==null||I.addEventListener("click",C);const S=document.querySelector("#hidden_upload");S==null||S.addEventListener("change",v),(M=document.querySelector("#upload"))==null||M.addEventListener("click",()=>S==null?void 0:S.click()),l()}catch(S){return R(S)}x("this is a demo web site for creating rustpotter models")}function b(c,u=!0){const d=document.querySelector("#"+c);d&&(d.disabled=!u)}function x(c){console.log(c);const u=document.querySelector("#terminal");u&&(u.innerHTML+='<span style="color: grey">'+i+'</span> % <span class="ok">'+c+"</span><br>",u.parentElement&&(u.parentElement.scrollTop=u.parentElement.scrollHeight))}function G(c,u=!0){u&&console.error(c);const d=document.querySelector("#terminal");d&&(d.innerHTML+='<span style="color: grey">'+i+'</span> % <span class="error">'+c+"</span><br>",d.parentElement&&(d.parentElement.scrollTop=d.parentElement.scrollHeight))}function R(c){console.error(c),G(c instanceof Error?"unexpected error:"+c.message:c+"",!1)}function yt(){const c=!!(window.navigator&&window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia);return window.AudioContext&&c}})()});export default Ae();
